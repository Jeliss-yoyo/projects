{"remainingRequest":"D:\\workspace\\HBuilderX\\SF-Team\\nkplat-design\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\workspace\\HBuilderX\\SF-Team\\nkplat-design\\src\\components\\layout\\custom-made.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\workspace\\HBuilderX\\SF-Team\\nkplat-design\\src\\components\\layout\\custom-made.vue","mtime":1611057097803},{"path":"D:\\workspace\\HBuilderX\\SF-Team\\nkplat-design\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1585119190579},{"path":"D:\\workspace\\HBuilderX\\SF-Team\\nkplat-design\\node_modules\\babel-loader\\lib\\index.js","mtime":1607477892317},{"path":"D:\\workspace\\HBuilderX\\SF-Team\\nkplat-design\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1585119190579},{"path":"D:\\workspace\\HBuilderX\\SF-Team\\nkplat-design\\node_modules\\vue-loader\\lib\\index.js","mtime":1609899827306}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB2dWVSZXNpYWJsZSBmcm9tICdAL2NvbXBvbmVudHMvcmVzaXphYmxlL3Z1ZS1yZXNpemFibGUnOwppbXBvcnQgeyAkY29tcG9uZW50cyB9IGZyb20gJ0AvY29tcG9uZW50cy9lbGVtZW50cy9jb21wb25lbnRzJzsKJGNvbXBvbmVudHMudnVlUmVzaWFibGUgPSB2dWVSZXNpYWJsZTsKZXhwb3J0IGRlZmF1bHQgewoJbmFtZTogJ2N1c3RvbS1tYWRlJywKCWNvbXBvbmVudHM6ICRjb21wb25lbnRzLAoJZGF0YSgpIHsKCQlyZXR1cm4gewoJCQkvLyDlvZPliY3pobnnm67kv6Hmga8KCQkJcHJvamVjdDogdGhpcy4kc3RvcmUuc3RhdGUucHJvamVjdCwKCQkJLy8gY3VzdG9tLW1hZGUg5a655Zmo5bC65a+4CgkJCXdyYXBTaXplOiBbXSwKCQkJLy8g6Jma5ouf5aSn5bGP55qE5bC65a+4CgkJCXZTY3JlZW5TaXplOiBbXSwKCQkJLy8g5b2T5YmN57yp5pS+5q+U5L6LCgkJCXZTY2FsZTogMSwKCQkJCgkJfQoJfSwKCXdhdGNoOiB7CgkJX2NvdW50ZXI6IHsKCQkJaGFuZGxlcihuLCBvKXsKCQkJCS8vY29uc29sZS5sb2coJ+iuvuiuoeS4reW/g+abtOaWsCcpOwoJCQkJdGhpcy4kZm9yY2VVcGRhdGUoKTsKCQkJfQoJCX0KCX0sCgljb21wdXRlZDogewoJCXNsaWRlKCkgewoJCQlyZXR1cm4gdGhpcy4kc3RvcmUuZ2V0dGVycy5fc2xpZGU7CgkJfSwKCQlpc0VsZW1lbnQoKSB7CgkJCXJldHVybiB0aGlzLiRzdG9yZS5zdGF0ZS5hY3RpdmUuaXNFbGVtQ2hlY2tlZDsKCQl9LAoJCWN1cnJlbnRFbGVJZCgpIHsKCQkJcmV0dXJuIHRoaXMuJHN0b3JlLnN0YXRlLmFjdGl2ZS5lbGVJZDsKCQl9LAoJCXZTY3JlZW5TdHlsZSgpIHsKCQkJcmV0dXJuIGAKCQkJCWJhY2tncm91bmQtY29sb3I6ICR7IHRoaXMuc2xpZGUuYmdDbHIgfTsKCQkJCWJhY2tncm91bmQtaW1hZ2U6IHVybCgkeyB0aGlzLnNsaWRlLmJnSW1hZ2UgfSk7CgkJCQliYWNrZ3JvdW5kLXNpemU6ICR7IHRoaXMuc2xpZGUuYmdTaXplIH07CgkJCWA7CgkJfSwKCQlfY291bnRlcigpIHsKCQkJcmV0dXJuIHRoaXMuJHN0b3JlLnN0YXRlLmNvdW50ZXI7CgkJfQoJfSwKCW1vdW50ZWQoKSB7CgkJdGhpcy5nZXRXcmFwU2l6ZSgpOwoJCXRoaXMuc2V0VmlydHVhbFNjcmVlbigpOwoJCXdpbmRvdy4kc3RvcmUgPSB0aGlzLiRzdG9yZTsKCX0sCgltZXRob2RzOiB7CgkJLy8g6I635Y+WIGN1c3RvbS1tYWRlIOWuueWZqOWwuuWvuAoJCWdldFdyYXBTaXplKCkgewoJCQljb25zdCB3cmFwID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2N1c3RvbS1tYWRlJyk7CgkJCWNvbnN0IHN0eWxlID0gd2luZG93LmdldENvbXB1dGVkU3R5bGUod3JhcCwgbnVsbCk7CgkJCXRoaXMud3JhcFNpemUgPSBbcGFyc2VGbG9hdChzdHlsZS53aWR0aCksIHBhcnNlRmxvYXQoc3R5bGUuaGVpZ2h0KV07CgkJfSwKCQkvLyDorr7nva7omZrmi5/lpKflsY/vvIjmoLnmja7pobnnm67liIbovqjnjofvvIzku6XkuIDlrprnmoTns7vmlbDov5vooYznrYnmr5TnvKnmlL7vvIkKCQlzZXRWaXJ0dWFsU2NyZWVuKCkgewoJCQljb25zdCBbcHcsIHBoXSA9IHRoaXMucHJvamVjdC5yZXNvbHV0aW9uOwoJCQljb25zdCBbcncsIHJoXSA9IHRoaXMud3JhcFNpemU7CgkJCWxldCB2c3csIHZzaCwgc2NhbGU7CgkJCS8vIOiuoeeul+acgOS9s+eahOiZmuaLn+Wkp+Wxj+WwuuWvuOS7peWPiue8qeaUvuezu+aVsAoJCQlpZiAocncgLyByaCA8PSBwdyAvIHBoKSB7CgkJCQl2c3cgPSBydzsKCQkJCXZzaCA9IHZzdyAqIHBoIC8gcHc7CgkJCX0gZWxzZSB7CgkJCQl2c2ggPSByaDsKCQkJCXZzdyA9IHZzaCAqIHB3IC8gcGg7CgkJCX0KCQkJc2NhbGUgPSB2c3cgLyBwdzsKCQkJdGhpcy52U2NhbGUgPSBzY2FsZTsKCQkJY29uc3QgdlNjcmVlbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyN2aXJ0dWFsLXNjcmVlbicpOwoJCQl2U2NyZWVuLnN0eWxlLmNzc1RleHQgPSBgCgkJCQl3aWR0aDogJHsgdnN3IC8gc2NhbGUgfXB4OyAKCQkJCWhlaWdodDogJHsgdnNoIC8gc2NhbGUgfXB4OwoJCQkJdHJhbnNmb3JtOiB0cmFuc2xhdGUoLTUwJSwgLTUwJSkgc2NhbGUoJHsgc2NhbGUgfSk7CgkJCWA7CgkJfSwKCQkvLyDngrnlh7vlhYPntKAKCQlvbkNsaWNrQm94KGVsZUlkKSB7CgkJCS8vIOS4pOasoeeCueWHu+eahOaYr+WQpuS4uuWQjOS4gOWFg+e0oAoJCQljb25zdCBpc1NhbWUgPSB0aGlzLmN1cnJlbnRFbGVJZCA9PT0gZWxlSWQ7CgkJCS8vIOS4jeWQjOWImeabtOaWsAoJCQkoIXRoaXMuaXNFbGVtZW50IHx8ICFpc1NhbWUpICYmIHRoaXMuJHN0b3JlLmNvbW1pdCgnX2FjdGl2ZScsIHsgZWxlSWQgfSk7CgkJfSwKCQkvLyDngrnlh7vlubvnga/niYcKCQlvbkNsaWNrVlNjcmVlbigpIHsKCQkJdGhpcy5pc0VsZW1lbnQgJiYgdGhpcy4kc3RvcmUuY29tbWl0KCdfYWN0aXZlJywge30pOwoJCX0sCgkJLy8g55uu5qCH5YWD57Sg5bmz56e75Y+Y5o2i77yM5bGe5oCn5pu05pawCgkJZ2V0Qm94SW5mbyhsZWZ0LCB0b3AsIHdpZHRoLCBoZWlnaHQpIHsKCQkJY29uc3QgYXR0ciA9IHsgd2lkdGgsIGhlaWdodCwgbGVmdCwgdG9wIH07CgkJCXRoaXMuJHN0b3JlLmNvbW1pdCgnX3Jlc2l6ZUVsZW1lbnQnLCBhdHRyKTsKCQl9LAoJCS8vIOe7hOS7tuWKoOi9veaIkOWKn+WQju+8jOWPluW+l+ivpee7hOS7tuebuOWFs+WxnuaAp++8jOaPkOS6pOWIsCB2dWV4CgkJZ2V0T3B0aW9ucyhlbGVJZCwgb3B0cykgewoJCQl0aGlzLiRzdG9yZS5jb21taXQoJ191cGRhdGVFbGVtZW50T3B0aW9uJywgeyBlbGVJZCwgb3B0cyB9KTsKCQl9Cgl9Cn0K"},{"version":3,"sources":["custom-made.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"custom-made.vue","sourceRoot":"src/components/layout","sourcesContent":["<template>\n\t<!-- 可视化定制区域 -->\n\t<div id=\"custom-made\">\n\t\t<!-- 虚拟大屏 -->\n\t\t<div id=\"virtual-screen\" :style=\"vScreenStyle\" @click.self=\"onClickVScreen\">\n\t\t\t<vueResiable\n\t\t\t\tv-for=\"(ele, k) in slide.elements\" \n\t\t\t\t:key=\"k\"\n\t\t\t\t:scaleRatio=\"vScale\"\n\t\t\t\t:eleId=\"k\"\n\t\t\t\t@resizing=\"getBoxInfo\"\n\t\t\t\t@onSelectElement=\"onClickBox\"\n\t\t\t\t:w=\"+ele.attribute.width\"\n\t\t\t\t:h=\"+ele.attribute.height\"\n\t\t\t\t:x=\"+ele.attribute.left\"\n\t\t\t\t:y=\"+ele.attribute.top\"\n\t\t\t\t:z=\"+ele.attribute.zIndex\"\n\t\t\t\t:bgClr=\"ele.attribute.bgClr\"\n\t\t\t\t:bgImage=\"ele.attribute.bgImage\"\n\t\t\t\t:bgSize=\"ele.attribute.bgSize\"\n\t\t\t>\n\t\t\t\t<component :is=\"ele.component\" :eleId=\"k\" @options=\"getOptions\" />\n\t\t\t</vueResiable>\n\t\t</div>\n\t</div>\n</template>\n\n<script>\n\timport vueResiable from '@/components/resizable/vue-resizable';\n\timport { $components } from '@/components/elements/components';\n\t$components.vueResiable = vueResiable;\n\texport default {\n\t\tname: 'custom-made',\n\t\tcomponents: $components,\n\t\tdata() {\n\t\t\treturn {\n\t\t\t\t// 当前项目信息\n\t\t\t\tproject: this.$store.state.project,\n\t\t\t\t// custom-made 容器尺寸\n\t\t\t\twrapSize: [],\n\t\t\t\t// 虚拟大屏的尺寸\n\t\t\t\tvScreenSize: [],\n\t\t\t\t// 当前缩放比例\n\t\t\t\tvScale: 1,\n\t\t\t\t\n\t\t\t}\n\t\t},\n\t\twatch: {\n\t\t\t_counter: {\n\t\t\t\thandler(n, o){\n\t\t\t\t\t//console.log('设计中心更新');\n\t\t\t\t\tthis.$forceUpdate();\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tcomputed: {\n\t\t\tslide() {\n\t\t\t\treturn this.$store.getters._slide;\n\t\t\t},\n\t\t\tisElement() {\n\t\t\t\treturn this.$store.state.active.isElemChecked;\n\t\t\t},\n\t\t\tcurrentEleId() {\n\t\t\t\treturn this.$store.state.active.eleId;\n\t\t\t},\n\t\t\tvScreenStyle() {\n\t\t\t\treturn `\n\t\t\t\t\tbackground-color: ${ this.slide.bgClr };\n\t\t\t\t\tbackground-image: url(${ this.slide.bgImage });\n\t\t\t\t\tbackground-size: ${ this.slide.bgSize };\n\t\t\t\t`;\n\t\t\t},\n\t\t\t_counter() {\n\t\t\t\treturn this.$store.state.counter;\n\t\t\t}\n\t\t},\n\t\tmounted() {\n\t\t\tthis.getWrapSize();\n\t\t\tthis.setVirtualScreen();\n\t\t\twindow.$store = this.$store;\n\t\t},\n\t\tmethods: {\n\t\t\t// 获取 custom-made 容器尺寸\n\t\t\tgetWrapSize() {\n\t\t\t\tconst wrap = document.querySelector('#custom-made');\n\t\t\t\tconst style = window.getComputedStyle(wrap, null);\n\t\t\t\tthis.wrapSize = [parseFloat(style.width), parseFloat(style.height)];\n\t\t\t},\n\t\t\t// 设置虚拟大屏（根据项目分辨率，以一定的系数进行等比缩放）\n\t\t\tsetVirtualScreen() {\n\t\t\t\tconst [pw, ph] = this.project.resolution;\n\t\t\t\tconst [rw, rh] = this.wrapSize;\n\t\t\t\tlet vsw, vsh, scale;\n\t\t\t\t// 计算最佳的虚拟大屏尺寸以及缩放系数\n\t\t\t\tif (rw / rh <= pw / ph) {\n\t\t\t\t\tvsw = rw;\n\t\t\t\t\tvsh = vsw * ph / pw;\n\t\t\t\t} else {\n\t\t\t\t\tvsh = rh;\n\t\t\t\t\tvsw = vsh * pw / ph;\n\t\t\t\t}\n\t\t\t\tscale = vsw / pw;\n\t\t\t\tthis.vScale = scale;\n\t\t\t\tconst vScreen = document.querySelector('#virtual-screen');\n\t\t\t\tvScreen.style.cssText = `\n\t\t\t\t\twidth: ${ vsw / scale }px; \n\t\t\t\t\theight: ${ vsh / scale }px;\n\t\t\t\t\ttransform: translate(-50%, -50%) scale(${ scale });\n\t\t\t\t`;\n\t\t\t},\n\t\t\t// 点击元素\n\t\t\tonClickBox(eleId) {\n\t\t\t\t// 两次点击的是否为同一元素\n\t\t\t\tconst isSame = this.currentEleId === eleId;\n\t\t\t\t// 不同则更新\n\t\t\t\t(!this.isElement || !isSame) && this.$store.commit('_active', { eleId });\n\t\t\t},\n\t\t\t// 点击幻灯片\n\t\t\tonClickVScreen() {\n\t\t\t\tthis.isElement && this.$store.commit('_active', {});\n\t\t\t},\n\t\t\t// 目标元素平移变换，属性更新\n\t\t\tgetBoxInfo(left, top, width, height) {\n\t\t\t\tconst attr = { width, height, left, top };\n\t\t\t\tthis.$store.commit('_resizeElement', attr);\n\t\t\t},\n\t\t\t// 组件加载成功后，取得该组件相关属性，提交到 vuex\n\t\t\tgetOptions(eleId, opts) {\n\t\t\t\tthis.$store.commit('_updateElementOption', { eleId, opts });\n\t\t\t}\n\t\t}\n\t}\n</script>\n\n<style scoped>\n\t#custom-made {\n\t\tposition: relative;\n\t\theight: 100%;\n\t\toverflow: hidden;\n\t}\n\t#virtual-screen {\n\t\tbackground-color: rgba(255, 255, 255, 0.2);\n\t\tposition: absolute;\n\t\ttop: 50%;\n\t\tleft: 50%;\n\t\tbackground-size: 100% 100%;\n\t}\n\t\n\t.bounce-enter-active {\n\t  animation: bounce-in 5s;\n\t}\n\t.bounce-leave-active {\n\t  animation: bounce-in 5s reverse;\n\t}\n\t@keyframes bounce-in {\n\t  0% {\n\t    transform: translateX(30);\n\t  }\n\t  50% {\n\t    transform: translateX(60);\n\t  }\n\t  100% {\n\t    transform: translateX(0);\n\t  }\n\t}\n</style>\n"]}]}